<% if notice %>
  <p id="notice"><%= notice %></p>
<% end %>

<h1><%=t('.title_html') %></h1>

<% @product.each do |product| %>
  <div class="entry">
    <%= link_to (image_tag(product.image_url)),{:controller => "products", :action => "show",:id => product.id } %>

    <h3><%= product.title %></h3>

    <%allcates = product.cate.split(";") %>
	  <%for cate in allcates%>
       <%if cate != nil%>
          <%= link_to (cate), {:controller => "subcategories", :action => "index",:subcate => cate } %>
       <%end%>
    <%end%>	
	  <br />

    <%= sanitize product.description %>
   
      <span class="price"><%= number_to_currency(product.price) %></span>
      <% if session[:user_id] %>
        <!--使用button_to创建到create action的链接。现在我们利用它发送AJAX请求，
        我们在调用中添加一个:remote => true参数-->
        <%= button_to t('.add_html'), line_items_path(:product_id => product, :modify => "false"),
          :remote => true %>
      <% else %>
        <button class="need_to_login">Add to cart</button>
      <% end %>
    <div class="price_line">
      <span class = "inventory">Inventory:<%= product.inventory%></span>
    </div>
  </div>
<% end %>

<p><%= will_paginate @product%></p>
